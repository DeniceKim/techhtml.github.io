<!DOCTYPE html>
<html lang="ko">
<meta charset="utf-8">
<title>웹 알림</title>
<style>
 pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em 1em }
 pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
 pre code { color:inherit; background:transparent }
 pre.css { border: solid 0.0625em; background: #FFFFEE; color: black; padding: 0.5em 1em; }
 .example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
 .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
 p.note::before { content:"Note: " }
 .XXX { padding:.5em; border:solid #f00 }
 p.XXX::before { content:"Issue: " }
 dl.switch { padding-left:2em }
 dl.switch > dt { text-indent:-1.5em }
 dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
 dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
 dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
 dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
 dl.domintro dd p { margin: 0.5em 0; }
 dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
 em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
 dfn { font-weight:bold; font-style:normal }
 code { color:orangered }
 code :link, code :visited { color:inherit }
 hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
 table { border-collapse:collapse; border-style:hidden hidden none hidden }
 table thead { border-bottom:solid }
 table tbody th:first-child { border-left:solid }
 table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }

 .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
 .warning p:first-child { margin-top: 0; }
 .warning p:last-child { margin-bottom: 0; }
 .warning:before { font-style: normal; }
 p.warning:before { content: '\26A0 Warning! '; }
</style>
<link href="http://www.w3.org/StyleSheets/TR/W3C-REC" rel="stylesheet">
<div class="head">
<!--begin-logo-->
<p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"></a></p>
<!--end-logo-->

<h1>웹 알림</h1>
<h2 class="no-num no-toc" id="w3c-recommendation-22-october-2015">2015년 10월 22일 W3C 권고안</h2>

<dl>
 <dt>이 버전:
 <dd class="publish"><a href="http://www.w3.org/TR/2015/REC-notifications-20151022/">http://www.w3.org/TR/2015/REC-notifications-20151022/</a>

 <dt class="publish">최신 버전:
 <dd class="publish"><a href="http://www.w3.org/TR/notifications/">http://www.w3.org/TR/notifications/</a>

 </dd>
 <dt>버전 히스토리:
 <dd><a href="http://dvcs.w3.org/hg/notifications/shortlog">http://dvcs.w3.org/hg/notifications/shortlog</a></dd>

 <dt>이전 버전:</dt>
 <dd><a href="http://www.w3.org/TR/2015/PR-notifications-20150910/">http://www.w3.org/TR/2015/PR-notifications-20150910/</a>
 <dd><a href="http://www.w3.org/TR/2015/CR-notifications-20150519/">http://www.w3.org/TR/2015/CR-notifications-20150519/</a>
 <dd><a href="http://www.w3.org/TR/2013/WD-notifications-20130912/">http://www.w3.org/TR/2013/WD-notifications-20130912/</a>
 <dd><a href="http://www.w3.org/TR/2012/WD-notifications-20120614/">http://www.w3.org/TR/2012/WD-notifications-20120614/</a>
 <dd><a href="http://www.w3.org/TR/2011/WD-notifications-20110301/">http://www.w3.org/TR/2011/WD-notifications-20110301/</a>

 <dt>Editor (former):
 <dd>John Gregg (<a href="http://www.google.com/">Google</a>)
 &lt;<a href="mailto:johnnyg@google.com">johnnyg@google.com</a>&gt;</dd>
 <dt>Editor (<a href="https://notifications.spec.whatwg.org/">https://notifications.spec.whatwg.org/</a> version):
 <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
 (<a href="http://www.mozilla.org/">Mozilla</a>)
 &lt;<a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>&gt;</dd>
</dl>

<p>이 문서의 발행 이후 알려진 에러나 이슈들은 <a href="http://www.w3.org/2010/web-notifications/errata.html"><strong>errata</strong></a>에서 확인 가능합니다.</p>

<p>이 문서의 표준문서는 영문버전만 제공합니다. 표준이 아닌 <a href="https://www.w3.org/2003/03/Translations/byTechnology?technology=notifications">번역본</a>도 있을 수 있습니다.</p>

<!--begin-copyright-->
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> &copy; 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>&reg;</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
<!--end-copyright-->

</div>

<hr class="top">

<h2 class="no-num no-toc" id="abstract">요약</h2>

<p>
웹 알림은 엔드 유저 알림을 위한 API를 제공합니다.
알림은 이메일과 같이, 유저 웹페이지 콘텍스트 밖에 발생시키는 걸 허용합니다.
</p>

<h2 class="no-num no-toc" id="sotd">이 문서의 상태</h2>
<p><em>이 섹션은 이 문서를 공개했을 때 상태에 대해 설명합니다.
	다른 문서가 이 문서를 덮어쓸 가능성이 있으니 주의하시길 바랍니다.
	이 문서 및 W3C에서 공개한 다른 문서의 최신 버전은 
	<a href="http://www.w3.org/TR/">W3C technical reports index</a> at http://www.w3.org/TR/에서
	확인 가능합니다.</em></p>

<p>이 문서는 웹 알림의 W3C 권고안입니다.</p>

<p>이 문서는 <abbr title="World Wide Web Consortium">W3C</abbr> 멤버, 소프트웨어 개발자, 그리고 다른 <abbr title="World Wide Web Consortium">W3C</abbr> 그룹 및 관계자들이 평가를 진행하여, 디렉터에 의해 <abbr title="World Wide Web Consortium">W3C</abbr> 권고안으로 발표했습니다. 
	이 문서는 안정적이며, 참고자료로 사용하거나 다른 문서에서 인용해도 좋습니다. 
	스펙 문서의 권고를 통해 W3C가 하는 역할은 스펙 문서에 관심을 모으고 다방면으로 퍼뜨리는 일입니다. 
	이를 통해 웹의 기능과 상호운용성 향상을 기대할 수 있습니다.</p>

<p>
W3C <a href="http://www.w3.org/2010/web-notifications/">웹 알림 워킹 그룹</a>은 이 스펙문서를 W3C 권고안으로 발행하는데 책임이 있는 W3C 워킹 그룹입니다.
이 문서에 대한 코멘트를 남기고 싶다면 
<a href="mailto:public-web-notification@w3.org">public-web-notification@w3.org</a>
(<a href="mailto:public-webapps-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-web-notification/">archive</a>)으로 메일을 보내주시길 바랍니다.

<p class="alt">
W3C는  <a href="#refsDOM4">[DOM4]</a>나 <a href="#refsWEBIDL">[WEBIDL]</a> 문서의 권고안 프로세스 진행으로 인한 변화에 따라,
이 권고안에서 정의하는 기술적인 부분에 영향을 받지 않을것이라 기대하고 있습니다.
</p>

<p>
이 스펙문서에 대한
<a href="https://github.com/w3c/web-platform-tests/tree/master/notifications">test suite</a> 및
<a href="https://w3c.github.io/test-results/notifications/">구현 보고서</a>를 참고하시길 바랍니다.</p>

<p class="alt">
<a href="https://notifications.spec.whatwg.org/">https://notifications.spec.whatwg.org/</a>에서도
웹에서 사용하는 알림에 대한 스펙 문서를 제공합니다.
최근 주목하고 있는 작업은 서비스 워커와 알림 통합 및 다른 새로운 특징들입니다.
위 스펙 문서에서는 이 스펙문서에는 존재하는 <code>onshow</code> 및 <code>onclose</code> 이벤트를 사용 사례가 부족한 이론적 근거를 이유로 제거하였습니다.
</p>
<p lang="ko">이 문서는 <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">2004년 2월 6일 W3C 특허 정책</a>을 따르는 그룹에서 작성하였습니다.
W3C는 그룹의 성과물에 관련하여 <a href="http://www.w3.org/2004/01/pp-impl/40318/status" rel="disclosure">모든 공개 특허 공개 리스트</a>를 관리합니다.
여기에는 특허 공개에 대한 지시사항도 포함합니다.
특허에 대해서 충분한 지식이 있는 사람이, 스펙 문서의 <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>에 인정된다고 파악되는 경우, <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">W3C 특허 정책 제 6장</a>에 의거하여 정보를 공개해야 할 필요가 있습니다.</p>
<p>이 문서는 <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">2015년 9월 1일  <abbr title="World Wide Web Consortium">W3C</abbr> 프로세스 문서</a>에 따릅니다.</p>

<h2 class="no-num no-toc" id="table-of-contents">목차</h2>

<!--begin-toc-->
<ul class="toc">
 <li><a href="#introduction"><span class="secno">1 </span>Introduction</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a>
  <ul class="toc">
   <li><a href="#security"><span class="secno">2.1 </span>Security</a></ul></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#model"><span class="secno">4 </span>Model</a>
  <ul class="toc">
   <li><a href="#direction-0"><span class="secno">4.1 </span>Direction</a></li>
   <li><a href="#language-0"><span class="secno">4.2 </span>Language</a></li>
   <li><a href="#permission"><span class="secno">4.3 </span>Permission</a></li>
   <li><a href="#notification-lists"><span class="secno">4.4 </span>Notification lists</a></li>
   <li><a href="#showing-a-notification"><span class="secno">4.5 </span>Showing a notification</a></li>
   <li><a href="#activating-a-notification"><span class="secno">4.6 </span>Activating a notification</a></li>
   <li><a href="#closing-a-notification"><span class="secno">4.7 </span>Closing a notification</a></li>
   <li><a href="#pending-notifications"><span class="secno">4.8 </span>Pending notifications</a></li>
   <li><a href="#displaying-notifications"><span class="secno">4.9 </span>Displaying notifications</a></li>
   <li><a href="#replacing-a-notification"><span class="secno">4.10 </span>Replacing a notification</a></ul></li>
 <li><a href="#api"><span class="secno">5 </span>API</a></li>
 <li><a href="#examples"><span class="secno">6 </span>Examples</a>
  <ul class="toc">
   <li><a href="#using-events"><span class="secno">6.1 </span>Using events</a></li>
   <li><a href="#tags-example"><span class="secno">6.2 </span>Using the <code title="">tag</code> member for multiple instances</a></li>
   <li><a href="#using-the-tag-member-for-a-single-instance"><span class="secno">6.3 </span>Using the <code title="">tag</code> member for a single instance</a></ul></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ul>
<!--end-toc-->



<h2 id="introduction"><span class="secno">1 </span>소개</h2>

<p>
이 스펙 문서는 유저 웹페이지의 콘텍스트 바깥쪽 경고를 위한 알림을 나타내는 API를 제공합니다.
이 스펙문서에서 "desktop" 상 알림 표시를 참고할 때, 일반적으로는 웹페이지의 바깥 정적 디스플레이 영역을 참고합니다.
하지만 여러가지 형태를 취할 수 있습니다:

<ul>
 <li>유저 디스플레이의 코너
 <li>유저 에이전트의 크롬 영역
 <li>모바일 기기의 "home" 화면
</ul>

<p>
유저 에이전트에서 어떻게 알림을 보여줄지에 대해서는 명확히 정의되어있지 않습니다.
가장 좋은 표현방법은 유저 에이전트가 동작하는 디바이스에 의존하는 것입니다.
API는 표시 옵션에 대하여 유연하게 디자인하고 있습니다.

<p>
이 스펙문서는 현존 알림 플랫폼에 가능한한 많이 호환하도록 설계하였으나, 플랫폼에 독립적입니다.
일반적인 플랫폼에서 똑같은 기능을 제공하지 않을 때, 이 스펙은 이벤트가 표시 될지 않을지를 보장합니다.
특히, 여기에서 정의하는 알림은 콘텐츠에 텍스트와 아이콘을 포함할 수 있습니다.
</p>

<p>
일반적으로, 알림을 위한 이벤트 모델은 최선형입니다.
<code><a href="#notification">Notification</a></code> 객체가 <code title="">click</code> 이벤트를 제공하는 동안,
어플리케이션은 이벤트를 수신하여 기능을 향상시킬 수 있지만,
그 기능을 제공하지 않는 경우, 플랫폼에서 알림을 제공할 수 없습니다.
</p>

<h2 id="conformance"><span class="secno">2 </span>적합 요구사항</h2>

<p>이 스펙문서 내에서 예제, 노트, 작성 가이드라인, 다이어그램 및 명시적으로 '이 섹션은 표준에 준하는 내용이 아닙니다'라 표기된 내용은 표준에 준하는 내용이 아닙니다. 그 외는 모두 표준에 준하는 내용입니다.

<p>이 스펙 문서 내 키워드 "MUST", "MUST NOT", "REQUIRED", "SHOULD", "SHOULD NOT",
"RECOMMENDED", "MAY", "OPTIONAL"는 <a href="#rfc2119">RFC 2119</a>에 기술되어있는대로 해석합니다.
가독성을 위해, 이 스펙문서에서 이 키워드들을 모두 대문자로 표기하지는 않습니다.</p>

<h3 id="security"><span class="secno">2.1 </span>보안</h3>

<p>
알림은 유저가 알림을 원한다고 알린 때에만 보여져야 합니다.
유저가 부정적인 경험을 생성하지 않기 위함입니다.

<h2 id="terminology"><span class="secno">3 </span>용어</h2>

<p>이 스펙문서에서 사용하는 대부분의 용어는 DOM, HTML, IDL, URL에서 따왔습니다.
<a href="#refsDOM4">[DOM4]</a>
<a href="#refsHTML5">[HTML5]</a>
<a href="#refsWEBIDL">[WEBIDL]</a>
<a href="#refsURL">[URL]</a>



<h2 id="model"><span class="secno">4 </span>모델</h2>

<p>A <dfn id="concept-notification" title="concept-notification">notification</dfn> allows alerting the
user outside the context of a web page that something happened, such as the
delivery of email.

<p>Each <a href="#concept-notification" title="concept-notification">notification</a> has a
<dfn id="title">title</dfn>, <dfn id="direction">direction</dfn>,
<dfn id="language">language</dfn>, and an <dfn id="origin">origin</dfn>.

<p>Each <a href="#concept-notification" title="concept-notification">notification</a> <em>can</em>
have an associated <dfn id="body">body</dfn>, <dfn id="tag">tag</dfn>, <dfn id="icon-url">icon URL</dfn>, and
<dfn id="icon-image">icon image</dfn>.

<p class="note">Developers are encouraged to not convey information
through an icon, sound, or vibration pattern that is not otherwise
accessible to the end user.
See <a href="http://www.w3.org/WAI/intro/wcag">WCAG</a> for more.

<h3 id="direction-0"><span class="secno">4.1 </span>Direction</h3>

<p>This section is written in terms equivalent to those used in the
Rendering section of HTML. <a href="#refsHTML5">[HTML5]</a>

<!-- keep this in sync with
     http://www.whatwg.org/specs/web-apps/current-work/#text-rendered-in-native-user-interfaces -->

<p>User agents are expected to honor the Unicode semantics of the text of a
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>
and <a href="#body">body</a>. Each is expected to be treated as an independent set
of one or more bidirectional algorithm paragraphs when displayed, as defined
by the bidirectional algorithm's rules P1, P2, and P3, including, for
instance, supporting the paragraph-breaking behavior of
U+000A LINE FEED (LF) characters. For each paragraph of the
<a href="#title">title</a> and <a href="#body">body</a>, the
<a href="#concept-notification" title="concept-notification">notification</a>'s
<a href="#direction">direction</a> provides the higher-level override of rules P2 and P3
if it has a value other than "<code title="">auto</code>".
<a href="#refsBIDI">[BIDI]</a>


<h3 id="language-0"><span class="secno">4.2 </span>Language</h3>

<!-- keep this in sync with
     http://www.whatwg.org/specs/web-apps/current-work/#attr-lang -->

<p>The <a href="#concept-notification" title="concept-notification">notification</a>'s
<a href="#language">language</a> specifies the primary language for the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>
and <a href="#body">body</a>. Its value is a valid BCP 47 language tag, or the
empty string. The empty string indicates that the primary language is
unknown. <a href="#refsLANG">[LANG]</a>


<h3 id="permission"><span class="secno">4.3 </span>Permission</h3>

<p><a href="#concept-notification" title="concept-notification">Notifications</a> can only be
displayed if the user (or user agent on behalf of the user) has granted
<dfn id="permission-0">permission</dfn>. The <a href="#permission-0">permission</a> to display
<a href="#concept-notification" title="concept-notification">notifications</a> for a given
<a class="external" href="https://www.w3.org/TR/html/browsers.html#origin">origin</a> can be one of three strings:

<dl>
 <dt>"<code title="">default</code>"
 <dd><p>This is equivalent to "<code title="">denied</code>", but the user has
 made no explicit choice thus far.

 <dt>"<code title="">denied</code>"
 <dd><p>This means the user does not want
 <a href="#concept-notification" title="concept-notification">notifications</a>.

 <dt>"<code title="">granted</code>"
 <dd><p>This means <a href="#concept-notification" title="concept-notification">notifications</a> can
 be displayed.
</dl>

<p class="note">There is no equivalent to "<code title="">default</code>"
meaning "<code title="">granted</code>". In that case
"<code title="">granted</code>" is simply returned as there would be no reason
for the application to ask for <a href="#permission-0">permission</a>.


<h3 id="notification-lists"><span class="secno">4.4 </span>Notification lists</h3>

<p>The user agent must keep a <dfn id="list-of-pending-notifications">list of pending notifications</dfn> and
a <dfn id="list-of-active-notifications">list of active notifications</dfn>.

<h3 id="showing-a-notification"><span class="secno">4.5 </span>Showing a notification</h3>

<p>The <dfn id="show-steps">show steps</dfn> for a given <var title="">notification</var> are:

<ol>
 <li><p>If <a href="#permission-0">permission</a> for <var title="">notification</var>'s
 <a href="#origin">origin</a> is not "<code title="">granted</code>", cancel any ongoing
 <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch">fetch</a> for
 <var title="">notification</var>'s <a href="#icon-url">icon URL</a>,
 <a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">queue a task</a> to
 <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
 named <code title="">error</code> on <var title="">notification</var>, and
 terminate these steps.

 <li><p>If there is a <a href="#concept-notification" title="concept-notification">notification</a>
 in the <a href="#list-of-pending-notifications">list of pending notifications</a> or the
 <a href="#list-of-active-notifications">list of active notifications</a> whose <a href="#tag">tag</a> equals
 <var title="">notification</var>'s <a href="#tag">tag</a> and whose
 <a href="#origin">origin</a> equals <var title="">notification</var>'s
 <a href="#origin">origin</a>, run the <a href="#replace-steps">replace steps</a> for that
 <a href="#concept-notification" title="concept-notification">notification</a> and
 <var title="">notification</var>, and then terminate these steps.

 <li><p>If the device allows notifications to be displayed immediately
 without limitations on the number of concurrent notifications, run
 the <a href="#display-steps">display steps</a> and terminate these steps.

 <li><p>If the device has limitations on the number of concurrent
 notifications, either immediately call to a notification platform which
 natively supports queueing, or append <var title="">notification</var> to the
 <a href="#list-of-pending-notifications">list of pending notifications</a>.
</ol>

<h3 id="activating-a-notification"><span class="secno">4.6 </span>Activating a notification</h3>

<p>When a <a href="#concept-notification" title="concept-notification">notification</a>
<var title="">notification</var> is activated by the user, assuming the underlying
notification platform supports activation, the user agent must, for each
<code><a href="#notification">Notification</a></code> object <a href="#tags-example">representing <var title="">notification</var></a>,
<a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">queue a task</a> to
<a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
named <code title="">click</code> on the <code><a href="#notification">Notification</a></code> object.

<p class="note">Throughout the web platform "activate" is intentionally misnamed as "click".

<p class="note">User agents are strongly encouraged to make
<code class="external" title="dom-window-focus"><a href="https://www.w3.org/TR/html/editing.html#dom-window-focus">window.focus()</a></code> work from within
the event listener for the event named <code title="">click</code> as a means of focusing the
browsing context related to the notification.

<h3 id="closing-a-notification"><span class="secno">4.7 </span>Closing a notification</h3>

<p>When a <a href="#concept-notification" title="concept-notification">notification</a> is closed,
either by the underlying notification platform or by the user, the
<a href="#close-steps">close steps</a> for it must be run.

<p>The <dfn id="close-steps">close steps</dfn> for a given <var title="">notification</var> are:

<ol>
 <li><p>If <var title="">notification</var> is neither in the
 <a href="#list-of-pending-notifications">list of pending notifications</a> nor in the
 <a href="#list-of-active-notifications">list of active notifications</a>, terminate these steps.

 <li><p><a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">Queue a task</a> to remove
 <var title="">notification</var> from either the
 <a href="#list-of-pending-notifications">list of pending notifications</a> or the
 <a href="#list-of-active-notifications">list of active notifications</a>, and
 <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
 named <code title="">close</code> on <var title="">notification</var>.
</ol>

<h3 id="pending-notifications"><span class="secno">4.8 </span>Pending notifications</h3>

<p>Whenever the <a href="#list-of-pending-notifications">list of pending notifications</a> is not empty, the
user agent must wait and monitor changes in the available notification space
on the device.

<p>When the available display space changes on the device such that a new
notification can be displayed, for example due to a previous notification
being dismissed, the user agent should run the <a href="#display-steps">display steps</a>
for the first <a href="#concept-notification" title="concept-notification">notification</a> in the
<a href="#list-of-pending-notifications">list of pending notifications</a> and then remove it from the
<a href="#list-of-pending-notifications">list of pending notifications</a>.

<h3 id="displaying-notifications"><span class="secno">4.9 </span>Displaying notifications</h3>

<p>The <dfn id="display-steps">display steps</dfn> for a given <var title="">notification</var>
are:

<ol>
 <li>
  <p>If the notification platform supports icons,
  <var title="">notification</var>'s <a href="#icon-url">icon URL</a> is set and has not
  yet been <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch" title="fetch">fetched</a>,
  <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch">fetch</a> it and wait for the resource to
  be fully downloaded.

  <p>Once <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch" title="fetch">fetching</a> has
  finished and if the image format is supported, set
  <var title="">notification</var>'s <a href="#icon-image">icon image</a> to the decoded resource.

 <li>
  <p><a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">Queue a task</a> to run these substeps:

  <ol>
   <li><p>Display <var title="">notification</var> on the device (e.g. by
   making the appropriate notification platform API call).

   <li><p>If displaying fails (e.g. the notification platform returns an
   error),
   <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
   named <code title="">error</code> on <var title="">notification</var> and
   terminate these steps.

   <li><p>Append <var title="">notification</var> to the
   <a href="#list-of-active-notifications">list of active notifications</a>.

   <li><p><a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">Fire an event</a>
   named <code title="">show</code> on <var title="">notification</var>.
  </ol>
</ol>


<h3 id="replacing-a-notification"><span class="secno">4.10 </span>Replacing a notification</h3>

<p>The <dfn id="replace-steps">replace steps</dfn> for replacing an <var title="">old</var>
<a href="#concept-notification" title="concept-notification">notification</a> with a
<var title="">new</var> one are:

<ol>
 <li>
  <p>If the notification platform supports icons,
  <var title="">new</var>'s <a href="#icon-url">icon URL</a> is set and has not
  yet been <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch" title="fetch">fetched</a>,
  <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch">fetch</a> it and wait for the resource to
  be fully downloaded.

  <p>Once <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch" title="fetch">fetching</a> has
  finished and the image format is supported, set
  <var title="">new</var>'s <a href="#icon-image">icon image</a> to the decoded resource.

 <li><p>If <var title="">old</var> is in the
 <a href="#list-of-pending-notifications">list of pending notifications</a>,
 <a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">queue a task</a> to replace
 <var title="">old</var> with <var title="">new</var>, in the same position, in
 the <a href="#list-of-pending-notifications">list of pending notifications</a>, and
 <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
 named <code title="">close</code> on <var title="">old</var>.

 <li>
  <p>Otherwise,
  <a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">queue a task</a> to replace
  <var title="">old</var> with <var title="">new</var>, in the same position, in
  the <a href="#list-of-active-notifications">list of active notifications</a>,
  <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
  named <code title="">close</code> on <var title="">old</var>, and
  <a class="external" href="https://www.w3.org/TR/dom/#concept-event-fire" title="concept-event-fire">fire an event</a>
  named <code title="">show</code> on <var title="">new</var>.

  <p>If the notification platform does not support replacement this
  requirement may be addressed by running the <a href="#close-steps">close steps</a> for
  <var title="">old</var> and then running the <a href="#display-steps">display steps</a> for
  <var title="">new</var>.

  <p class="note">Notification platforms are strongly encouraged to support
  native replacement. It is much nicer.
</ol>



<h2 id="api"><span class="secno">5 </span>API</h2>

<p>A <a href="#concept-notification" title="concept-notification">notification</a> is represented by
a <code><a href="#notification">Notification</a></code> object and can be created by its
<a href="#dom-notification" title="dom-Notification">constructor</a>.

<pre class="idl">[<a href="#dom-notification" title="dom-Notification">Constructor</a>(DOMString <var title="">title</var>, optional <a href="#notificationoptions">NotificationOptions</a> <var title="">options</var>)]
interface <dfn id="notification">Notification</dfn> : <a class="external" href="https://www.w3.org/TR/dom/#eventtarget">EventTarget</a> {
  static readonly attribute <a href="#notificationpermission">NotificationPermission</a> <a href="#dom-notification-permission" title="dom-Notification-permission">permission</a>;
  static void <a href="#dom-notification-requestpermission" title="dom-Notification-requestPermission">requestPermission</a>(optional <a href="#notificationpermissioncallback">NotificationPermissionCallback</a> <var title="">callback</var>);

  attribute <a class="external" href="https://www.w3.org/TR/html/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onclick" title="handler-onclick">onclick</a>;
  attribute <a class="external" href="https://www.w3.org/TR/html/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onshow" title="handler-onshow">onshow</a>;
  attribute <a class="external" href="https://www.w3.org/TR/html/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onerror" title="handler-onerror">onerror</a>;
  attribute <a class="external" href="https://www.w3.org/TR/html/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onclose" title="handler-onclose">onclose</a>;

  readonly attribute DOMString <a href="#dom-notification-title" title="dom-Notification-title">title</a>;
  readonly attribute <a href="#notificationdirection">NotificationDirection</a> <a href="#dom-notification-dir" title="dom-Notification-dir">dir</a>;
  readonly attribute DOMString <a href="#dom-notification-dir" title="dom-Notification-dir">lang</a>;
  readonly attribute DOMString <a href="#dom-notification-dir" title="dom-Notification-dir">body</a>;
  readonly attribute DOMString <a href="#dom-notification-dir" title="dom-Notification-dir">tag</a>;
  readonly attribute DOMString <a href="#dom-notification-dir" title="dom-Notification-dir">icon</a>;

  void <a href="#dom-notification-close" title="dom-Notification-close">close</a>();
};

dictionary <dfn id="notificationoptions">NotificationOptions</dfn> {
  <a href="#notificationdirection">NotificationDirection</a> dir = "auto";
  DOMString lang = "";
  DOMString body;
  DOMString tag;
  DOMString icon;
};

enum <dfn id="notificationpermission">NotificationPermission</dfn> {
  "default",
  "denied",
  "granted"
};

callback <dfn id="notificationpermissioncallback">NotificationPermissionCallback</dfn> = void (<a href="#notificationpermission">NotificationPermission</a> <var title="">permission</var>);

enum <dfn id="notificationdirection">NotificationDirection</dfn> {
  "auto",
  "ltr",
  "rtl"
};</pre>

<p>The
<dfn id="dom-notification" title="dom-Notification"><code>Notification(<var title="">title</var>, <var title="">options</var>)</code></dfn>
constructor must run these steps:

<ol>
 <li><p>Let <var title="">notification</var> be a new
 <a href="#concept-notification" title="concept-notification">notification</a> represented by a
 <code><a href="#notification">Notification</a></code> object.

 <li><p>Set <var title="">notification</var>'s <a href="#title">title</a> to
 <var title="">title</var>.

 <li><p>Set <var title="">notification</var>'s <a href="#direction">direction</a> to
 <var title="">options</var>'s <code title="">dir</code>.

 <li><p>If <var title="">options</var>'s <code title="">lang</code> is a valid
 BCP 47 language tag, or the empty string, set
 <var title="">notification</var>'s <a href="#language">language</a> to
 <var title="">options</var>'s <code title="">lang</code>. Otherwise, set it
 to the empty string. <a href="#refsLANG">[LANG]</a>

 <li><p>Set <var title="">notifications</var>'s <a href="#origin">origin</a> to the
 current <a class="external" href="https://www.w3.org/TR/html/browsers.html#origin">origin</a>.

 <li><p>If <var title="">options</var>'s <code title="">body</code> is present,
 set <var title="">notification</var>'s <a href="#body">body</a> to
 <code title="">body</code>.

 <li><p>If <var title="">options</var>'s <code title="">tag</code> is present, set
 <var title="">notification</var>'s <a href="#tag">tag</a> to <code title="">tag</code>.

 <li><p>If <var title="">options</var>'s <code title="">icon</code> is present,
 <a class="external" href="https://www.w3.org/TR/url/#concept-url-parser" title="concept-url-parser">parse</a>
 <code title="">icon</code> using the <a class="external" href="https://www.w3.org/TR/html/webappapis.html#api-base-url">API base URL</a>
 specified by the <a class="external" href="https://www.w3.org/TR/html/webappapis.html#entry-settings-object">entry settings object</a>, and if that
 does not return failure, set <var title="">notification</var>'s <a href="#icon-url">icon URL</a> to the
 return value.

 <li><p>Return <var title="">notification</var>, but continue running these
 steps asynchronously.

 <li><p>If <a href="#icon-url">icon URL</a> is set and the notification platform
 supports icons, the user agent may start <a class="external" href="https://www.w3.org/TR/html/infrastructure.html#fetch" title="fetch">fetching</a>
 the <var title="">notification</var>'s <a href="#icon-url">icon URL</a> at this
 point.

 <li><p>Run the <a href="#show-steps">show steps</a> for <var title="">notification</var>.
</ol>

<p>The static
<dfn id="dom-notification-permission" title="dom-Notification-permission"><code>permission</code></dfn>
attribute must return <a href="#permission-0">permission</a>.

<p>The static
<dfn id="dom-notification-requestpermission" title="dom-Notification-requestPermission"><code>requestPermission(<var title="">callback</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Return, but continue running these steps asynchronously.

 <li><p>Let <var title="">permission</var> be <a href="#permission-0">permission</a>.

 <li><p>If <var title="">permission</var> is "<code title="">default</code>",
 ask the user whether showing notifications for the current
 <a class="external" href="https://www.w3.org/TR/html/browsers.html#origin">origin</a> is acceptable. If it is, set
 <var title="">permission</var> to "<code title="">granted</code>", or
 "<code title="">denied</code>" otherwise.

 <li><p><a class="external" href="https://www.w3.org/TR/html/webappapis.html#queue-a-task">Queue a task</a> to set
 <a href="#permission-0">permission</a> to <var title="">permission</var> and invoke
 <var title="">callback</var> with <var title="">permission</var> as single
 argument if <var title="">callback</var> is given.
</ol>

<p class="warning">In designing the platform notifications are the one
instance thus far where asking the user upfront makes sense. Specifications
for other APIs should not use this pattern and instead employ one of the
<a href="http://robert.ocallahan.org/2011/06/permissions-for-web-applications_30.html">many more suitable alternatives</a>.

<p>The following are the <a class="external" href="https://www.w3.org/TR/html/webappapis.html#event-handlers">event handlers</a>
(and their corresponding
<a class="external" href="https://www.w3.org/TR/html/webappapis.html#event-handler-event-type" title="event handler event type">event handler event types</a>)
that must be supported as attributes by the <code><a href="#notification">Notification</a></code> object.

<table>
 <thead>
  <tr>
   <th><a class="external" href="https://www.w3.org/TR/html/webappapis.html#event-handlers" title="event handlers">event handler</a>
   <th><a class="external" href="https://www.w3.org/TR/html/webappapis.html#event-handler-event-type">event handler event type</a>
 <tbody>
  <tr>
   <td><dfn id="handler-onclick" title="handler-onclick"><code>onclick</code></dfn>
   <td><code title="event-click">click</code>
  <tr>
   <td><dfn id="handler-onshow" title="handler-onshow"><code>onshow</code></dfn>
   <td><code title="event-show">show</code>
  <tr>
   <td><dfn id="handler-onerror" title="handler-onerror"><code>onerror</code></dfn>
   <td><code title="event-error">error</code>
  <tr>
   <td><dfn id="handler-onclose" title="handler-onclose"><code>onclose</code></dfn>
   <td><code title="event-close">close</code>
</table>

<p>The <dfn id="dom-notification-close" title="dom-Notification-close"><code>close()</code></dfn> method
must run the <a href="#close-steps">close steps</a> for the
<a href="#concept-notification" title="concept-notification">notification</a>.

<p>The <dfn id="dom-notification-title" title="dom-Notification-title"><code>title</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>.

<p>The <dfn id="dom-notification-dir" title="dom-Notification-dir"><code>dir</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#direction">direction</a>.

<p>The <dfn id="dom-notification-lang" title="dom-Notification-lang"><code>lang</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#language">language</a>.

<p>The <dfn id="dom-notification-body" title="dom-Notification-body"><code>body</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#body">body</a> and the empty
string otherwise.

<p>The <dfn id="dom-notification-tag" title="dom-Notification-tag"><code>tag</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#tag">tag</a> or the empty
string if it has no tag.

<p>The <dfn id="dom-notification-icon" title="dom-Notification-icon"><code>icon</code></dfn> attribute must return the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#icon-url">icon URL</a>,
<a class="external" href="https://www.w3.org/TR/url/#concept-url-serializer" title="concept-url-serializer">serialized</a>, and the
empty string otherwise.



<h2 id="examples"><span class="secno">6 </span>Examples</h2>

<h3 id="using-events"><span class="secno">6.1 </span>Using events</h3>

<p><code><a href="#notification">Notification</a></code> objects dispatch events during their lifecycle,
which developers can use to generate desired behaviors.

<p>The <code title="event-show">show</code> event dispatches when the
<a href="#concept-notification" title="concept-notification">notification</a> is shown to the user
&mdash; this may be at some time after the notification is created in the
case of limited display space and a queue.

<p>In the following example, this event is used to guarantee that regardless
of when the notification is shown, it is displayed for only 15 seconds.

<pre class="example">var notification = new Notification("New Email Received", { icon: "mail.png" })
notification.onshow = function() { setTimeout(notification.close, 15000) }</pre>

<p>The <code title="event-close">close</code> event dispatches when the
notification is dismissed by the user. Developers may use this event to
perform actions when notifications are acknowledged.

<p>In the following example, when a meeting reminder notification is
acknowledged, the application suppresses other forms of reminders.

<pre class="example">var notification = new Notification("Meeting about to begin", { icon: "calendar.gif", body: "Room 101" })
notification.onclose = function(event) { cancelReminders(event) }</pre>


<h3 id="tags-example"><span class="secno">6.2 </span>Using the <code title="">tag</code> member for multiple instances</h3>

<p>Web applications frequently operate concurrently in multiple instances, such as when a
	user opens a mail application in multiple browser tabs.  Since the desktop is a shared
	resource, the notifications API provides a way for these instances to easily coordinate, by
	using the <code title="">tag</code> member.

<p>Notifications which represent the same conceptual event can be tagged in the same way,
	and when both are shown, the user will only receive one notification.
      </p>

<pre class="example" title="">Instance 1                                   | Instance 2
                                             |
// Instance notices there is new mail.       |
new Notification("New mail from John Doe",   |
                 { tag: 'message1' });       |
                                             |
                                             |  // Slightly later, this instance notices
                                             |  // there is new mail.
                                             |  new Notification("New mail from John Doe",
                                             |                   { tag: 'message1' });</pre>

<p>
	The result of this situation, if the user agent follows the algorithms here, is a <strong>single</strong> notification "New mail from John Doe".

<h3 id="using-the-tag-member-for-a-single-instance"><span class="secno">6.3 </span>Using the <code title="">tag</code> member for a single instance</h3>

<p>The <code title="">tag</code> member can also be used by a single instance of an application to keep its
	notifications as current as possible as state changes.

<p>For example, if Alice is using a chat application with Bob, and Bob sends multiple
	messages while Alice is idle, the application may prefer that Alice not see a
	desktop notification for each message.

<pre class="example">// Bob says "Hi"
new Notification("Bob: Hi", { tag: 'chat_Bob' });

// Bob says "Are you free this afternoon?"
new Notification("Bob: Hi / Are you free this afternoon?", { tag: 'chat_Bob' });</pre>

<p>The result of this situation is a <em>single</em> notification; the second one
	replaces the first having the same tag.  In a platform that queues notifications
	(first-in-first-out), using the tag allows the notification to also maintain its
	position in the queue.  Platforms where the newest notifications are shown first,
	a similar result could be achieved using the
	<code title="dom-Notification-close"><a href="#dom-notification-close">close()</a></code> method.



<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsBIDI">[BIDI]
<dd><cite><a href="http://www.unicode.org/reports/tr9/">Unicode Bidirectional Algorithm</a></cite>, Mark Davis. Unicode Consortium.

<dt id="refsDOM4">[DOM4]
<dd><cite><a href="http://www.w3.org/TR/dom/">DOM</a></cite>, Anne van Kesteren, Aryeh Gregor, Ms2ger et al.. W3C.

<dt id="refsHTML5">[HTML5]
<dd><cite><a href="https://www.w3.org/TR/2014/REC-html5-20141028/">HTML5</a></cite>, Robin Berjon, Steve Faulkner, Travis Leithead et al.. W3C.

<dt id="refsLANG">[LANG]
<dd><cite><a href="https://tools.ietf.org/html/bcp47">Tags for Identifying Languages; Matching of Language Tags</a></cite>, Addison Phillips and Mark Davis. IETF.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

<dt id="refsURL">[URL]
<dd><cite><a href="http://www.w3.org/TR/url/">URL</a></cite>, Eric Arvidsson, Michael[tm] Smith. W3C.

<dt id="refsWEBIDL">[WEBIDL]
<dd><cite><a href="https://www.w3.org/TR/2015/PR-notifications-20150910/">Web IDL</a></cite>, Cameron McCormack. W3C.

</dl></div>



<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>Thanks to
Aharon (Vladimir) Lanin,
Alex Russell,
David H&aring;s&auml;ther,
Doug Turner,
Drew Wilson,
Jake Archibald,
Edward O'Connor,
Frederick Hirsch,
Ian Hickson,
James Graham,
Jon Lee,
Jonas Sicking,
Josh Soref,
Michael Cooper,
Michael Henretty,
Olli Pettay, and
Simon Pieters
for being awesome.

Special thanks to Anne van Kesteren for his continuing work on the
WHATWG's <a href="http://notifications.spec.whatwg.org/">Notifications
API Standard</a>.

  

